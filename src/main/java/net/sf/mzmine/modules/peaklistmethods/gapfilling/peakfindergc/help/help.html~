<html>
    <head>
        <title>Gap filling - Peak finder GC</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="stylesheet" type="text/css" href="/net/sf/mzmine/desktop/impl/helpsystem/HelpStyles.css">
    </head>

    <body>

        <h1>Peak finder GC</h1>

        <h2>Description</h2>
        <p>
            Following alignment, the resulting peak list may contain missing
            peaks as a product of a deficient peak detection or a mistake in the alignment of
            different peak lists.
		</p>
		
		<p>
            The fact that one peak is missing after the alignment does not imply that the
            peak does not exits. In most cases it is present but was undetected by the
            previous algorithms.
        </p>

        <p>
            This algorithm fills the gaps in the peak list when it is possible according with the parameters
            defined by the user (A new deconvolution - local minima search algorithm - is run in the area of interest with potentially thinner settings).
            The most crucial parameters are "m/z tolerance" and "RT tolerance" which define the window where
            the algorithm should find the new peak. It is centered in the m/z average and retention time average of
            the source peak list. Once the best candidate is found inside the window, its intensity and its shape in RT direction is also
            checked.
		</p>
		
		<p>
            It can also add a previous correction of the retention time in the case it is needed. It will
            change the position of the defined window depending on the prediction of a RT model created
            using all the already aligned peaks in each pair.
        </p>

        <h4>RT correction</h4>
        <p>
	      RT correction can be handle of different manners here (depending on the combination with options "<b>RT Correction</b>" and "<b>Use regression</b>").<br>
	      Possibilities are:
	      <ol>
			<li>No RT correction</li>		      
			<li>
			RT correction & No Regression
			<ol type="a">
			<li>"offset/scale" info available from previous "<a href="/net/sf/mzmine/modules/peaklistmethods/alignment/joingc/help/help.html">Join aligner GC</a>" task</li>		     
			<li>"offset/scale" info not available => Switch (=fallback) to regression</li>		     
			</ol>
			</li>		      
			<li>RT correction & Regression</li>		      
	      </ol>
        </p>
        <p>
            When "Use regression" ("RT correction" checked) is applied, the algorithm is divided in two main steps. In the first step,
            one random sample is taken from the multiple peak list and is used as a master list. All the gaps of this master list are filled using all the others samples.
            For each pair of samples the algorithm creates a model of the retention time.
            In the second step the master list is used to fill the gaps of the rest of the samples,
            creating also a retention time model for each pair (as it is showed in the figure below).

        </p>

        <p>
            <img src="gapfilling.png" name="scheme">
        </p>



        <h4>Method parameters</h4>

        <dl>
            <dt>Name suffix</dt>
            <dd>Suffix to be added to the peak list name</dd>

            <dt>M/Z tolerance</dt>
            <dd>This value sets the range, in terms of m/z, to search for possible peak in the raw
                data. Maximum allowed m/z difference</dd>

            <dt>RT row deviation tolerance</dt>
            <dd>Amount of overlapping between search ranges for two adjacent RT values 
            (0.0 => no overlap, i.e. a "gap-filled" peak won't be assigned to several columns)</dd>

            <dt>Minimum similarity score</dt>
            <dd>Minimum chemical similarity score to allow a peak to run for candidate to fill the gap</dd>

            <dt>RT Correction</dt>
            <dd>When it is checked, correction of the retention time will be applied to avoid the problems caused by the deviation
                of the retention time between the samples</dd>

            <dt>Use regression</dt>
            <dd>Ignored if "RT correction" isn't checked. If checked, RT correction is performed using a polynomial regression
            approach among already detected peaks, rather than the "offset/scale" values potentially inherited from 
            an eventual previous "<a href="/net/sf/mzmine/modules/peaklistmethods/alignment/joingc/help/help.html">Join aligner GC</a>" step</dd>

            <dt>Search minimum in RT range (min)</dt>
            <dd>Limiting RT bounds: If a local minimum is minimal in this range of retention time, it will be considered a border between two peaks</dd>

            <dt>Min ratio of peak top/edge</dt>
            <dd>Limiting peak shape: Minimum ratio between peak's top intensity and side (lowest) data points. 
            This parameter helps to reduce detection of false peaks in case the chromatogram is not smooth</dd>

            <dt>Peak duration range (min)</dt>
            <dd>Limiting peak width: Range of acceptable peak lengths</dd>

        </dl>
        
	<hr align="center" width="50">        
        
         <h2>Resulting table</h2>
         <p>
         New peak list showing the filled peaks with a yellow mark.<br>
         <br>
         <img src="gapfilled-rt-recalibration.png" width="1200" height="268" alt="">
         </p>
        	<p>
			Light yellow cells show peaks that the algorithm was able to recover. Those are tagged as "<b>ESTIMATED</b>". 
			If one of the Retention Time correction methods was used, the corrected RT value used to adjust the RT search area for recovering the peak
			is named into brackets.
        	</p>

    </body>
</html>


